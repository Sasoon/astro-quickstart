---

---

<script>
  // buttons
  var sm = $(".buy-button--small");
  var md = $(".buy-button--medium");
  var lg = $(".buy-button--large");
  var btn = $(".buy-button");

  // frame selectors
  var smFrame = $(".frame-selector.sm");
  var mdFrame = $(".frame-selector.md");
  var lgFrame = $(".frame-selector.lg");
  var frameSelector = $(".frame-selector");

  // default to medium size
  btn.hide();
  frameSelector.hide();
  md.show();
  mdFrame.show();

  // default pricing (medium + paper frame)
  var priceText = $(".price");
  console.log(priceText);
  var price = parseInt($(".buy-button:visible").data("item-price"));

  // price calculator
  function priceCalc() {
    sizeHandler();
    frameHandler();
    priceText.text("$" + parseInt($(".qty").val()) * price);
  }

  // global handler
  $("select").on("change", function () {
    priceCalc();
  });

  $(".qty").change(function () {
    var qty = parseInt($(".qty").val());
    console.log(qty);
    $(".buy-button:visible").attr("data-item-quantity", qty);
    priceText.text("$" + qty * price);
    console.log("price from qty: " + price);
  });

  // size handler
  function sizeHandler() {
    // get size value
    var size = $(".size-selector")[0].value;
    // hide all buttons
    btn.hide();
    frameSelector.hide();
    // price modifier + show relevant buy button
    switch (size) {
      case "sm":
        sm.show();
        smFrame.show();
        price = parseInt($(".buy-button:visible").data("item-price"));
        break;
      case "md":
        md.show();
        mdFrame.show();
        price = parseInt($(".buy-button:visible").data("item-price"));
        break;
      case "lg":
        lg.show();
        lgFrame.show();
        price = parseInt($(".buy-button:visible").data("item-price"));
        break;
      default:
        price = parseInt($(".buy-button:visible").data("item-price"));
    }
    btn.attr("data-item-quantity", 1);
    $(".qty").val(1);
  }

  // frame handler
  function frameHandler() {
    Snipcart.subscribe("page.validating", function (ev, data) {
      console.log(ev.type);
      if (ev.type == "shipping-address" && data.phone.substr(0, 3) != "+1.") {
        ev.addError("phone", "Please enter a US or Canadian phone number");
      }
    });
    // get frame value
    var frame = $(".frame-selector:visible")[0].selectedOptions[0].value;
    var framePrice = $(".frame-selector:visible")[0].selectedOptions[0].dataset
      .price;
    console.log("frame!" + frame);
    console.log(framePrice);
    // assign frame to buy button
    $(".buy-button:visible").attr("data-item-custom1-value", "frame");
    // frame price modifier
    switch (frame) {
      case { frame1 }:
      case { frame2 }:
        price =
          parseInt($(".buy-button:visible").data("item-price")) +
          parseInt(framePrice);
        console.log("sm");
        console.log(price);
        break;
      case { frame3 }:
      case { frame4 }:
        price =
          parseInt($(".buy-button:visible").data("item-price")) +
          parseInt(framePrice);
        console.log("md");
        break;
      case { frame5 }:
      case { frame6 }:
        price =
          parseInt($(".buy-button:visible").data("item-price")) +
          parseInt(framePrice);
        console.log("lg");
        break;
      default:
    }
  }

  // run price calc on load
  priceCalc();
</script>